<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Twitter App</title>
	</head>
	<body>
	<h1>love VS hate</h1>
	<div>
		<h3>Love</h3>
		<p class="js-love">0</p>
		<button class="js-btn" data-value="love" type="button">
			love
		</button>
		<button class="js-btn" data-value="passion" type="button">
			passion
		</button>
		<button class="js-btn" data-value="lust" type="button">
			lust
		</button>
	</div>
	<div>
		<h3>Hate</h3>
		<p class="js-hate">0</p>
	</div>
	</body>


	<script>
		const socket = new WebSocket(`ws://${window.location.hostname}:${window.location.port}`);

		socket.addEventListener('message', async function (event) {
			try{
				let data = await event.data.text()
				data = JSON.parse(data)
				const love = document.querySelector('.js-love')
				love.innerHTML = data.love
				const hate = document.querySelector('.js-hate')
				hate.innerHTML = data.hate
				console.log("server message: ", data)
			} catch(err){
			}
		});

		socket.addEventListener('open', function (event) {
			console.log('connected', event)
			// socket.send('Hello from client')
		});

		const buttons = document.querySelectorAll('.js-btn')

		buttons.forEach((button) => {
			button.addEventListener('click', () => {
				socket.send(button.dataset.value)
			})
		})

	</script>
</html>
